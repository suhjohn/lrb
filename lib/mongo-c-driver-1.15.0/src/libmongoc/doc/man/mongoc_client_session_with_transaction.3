.\" Man page generated from reStructuredText.
.
.TH "MONGOC_CLIENT_SESSION_WITH_TRANSACTION" "3" "Aug 13, 2019" "1.15.0" "MongoDB C Driver"
.SH NAME
mongoc_client_session_with_transaction \- mongoc_client_session_with_transaction()
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
bool
mongoc_client_session_with_transaction (mongoc_client_session_t *session,
                                        mongoc_client_session_with_transaction_cb_t cb,
                                        const mongoc_transaction_opt_t *opts,
                                        void *ctx,
                                        bson_t *reply,
                                        bson_error_t *error);
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
This method will start a new transaction on \fBsession\fP, run \fBcb\fP, and then commit the transaction. If it cannot commit the transaction, the entire sequence may be retried, and \fBcb\fP may be run multiple times. \fBctx\fP will be passed to \fBcb\fP each time it is called.
.sp
This method has an internal time limit of 120 seconds, and will retry until that time limit is reached. This timeout is not configurable.
.sp
\fBcb\fP should not attempt to start new transactions, but should simply run operations meant to be contained within a transaction. The \fBcb\fP does not need to commit transactions; this is handled by the \fBmongoc_client_session_with_transaction\fP\&. If \fBcb\fP does commit or abort a transaction, however, this method will return without taking further action.
.sp
The parameter \fBreply\fP is initialized even upon failure to simplify memory management.
.SH PARAMETERS
.INDENT 0.0
.IP \(bu 2
\fBsession\fP: A \fBmongoc_client_session_t\fP\&.
.IP \(bu 2
\fBcb\fP: A \fBmongoc_client_session_with_transaction_cb_t\fP callback, which will run inside of a new transaction on the session.
.IP \(bu 2
\fBopts\fP: An optional \fBmongoc_transaction_opt_t\fP\&.
.IP \(bu 2
\fBctx\fP: A \fBvoid*\fP\&. This user\-provided data will be passed to \fBcb\fP\&.
.IP \(bu 2
\fBreply\fP: An optional location to initialize a \fI\%bson_t\fP or \fBNULL\fP\&. This should be on the stack.
.IP \(bu 2
\fBerror\fP: An optional location for a \fI\%bson_error_t\fP or \fBNULL\fP\&.
.UNINDENT
.SH RETURN
.sp
Returns \fBtrue\fP if the transaction was completed succesfully.  Otherwise, returns \fBfalse\fP in case of failure.  In cases of failure \fBerror\fP will also be set, except if the passed\-in \fBcb\fP fails without setting \fBerror\fP\&.  If a non\-NULL \fBreply\fP is passed in, \fBreply\fP will be set to the value of the last server response, except if the passed\-in \fBcb\fP fails without setting a \fBreply\fP\&.
.SH AUTHOR
MongoDB, Inc
.SH COPYRIGHT
2017-present, MongoDB, Inc
.\" Generated by docutils manpage writer.
.
